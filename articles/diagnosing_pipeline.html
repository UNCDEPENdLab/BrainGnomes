<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Diagnosing Pipeline Runs • BrainGnomes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnosing Pipeline Runs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainGnomes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/braingnomes_quickstart.html">BrainGnomes Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/building_containers.html">Building Singularity containers for BrainGnomes</a></li>
    <li><a class="dropdown-item" href="../articles/diagnosing_pipeline.html">Diagnosing Pipeline Runs</a></li>
    <li><a class="dropdown-item" href="../articles/extract_rois.html">Extracting ROI Timeseries and Connectivity</a></li>
    <li><a class="dropdown-item" href="../articles/postprocessing.html">BrainGnomes Postprocessing Walkthrough</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UNCDEPENdLab/BrainGnomes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Diagnosing Pipeline Runs</h1>
                        <h4 data-toc-skip class="author">Michael
Hallquist</h4>
            
            <h4 data-toc-skip class="date">16 Feb 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UNCDEPENdLab/BrainGnomes/blob/main/vignettes/diagnosing_pipeline.Rmd" class="external-link"><code>vignettes/diagnosing_pipeline.Rmd</code></a></small>
      <div class="d-none name"><code>diagnosing_pipeline.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When <code><a href="../reference/run_project.html">run_project()</a></code> launches many jobs, it can be hard to
quickly answer:</p>
<ul>
<li>What already succeeded?</li>
<li>What is still running?</li>
<li>What failed?</li>
<li>What should I inspect next?</li>
</ul>
<p>This vignette shows a practical diagnosis workflow using:</p>
<ul>
<li>
<code><a href="../reference/get_project_status.html">get_project_status()</a></code> for a project-wide status
table</li>
<li>
<code><a href="../reference/get_subject_status.html">get_subject_status()</a></code> for one subject</li>
<li>
<code><a href="../reference/diagnose_pipeline.html">diagnose_pipeline()</a></code> for interactive, log-driven
debugging</li>
</ul>
<p>The examples below were run on this project:</p>
<p><code>/proj/mnhallqlab/projects/bg08test_14feb2026</code></p>
<div class="section level3">
<h3 id="load-the-project">Load the project<a class="anchor" aria-label="anchor" href="#load-the-project"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://uncdependlab.github.io/BrainGnomes/">BrainGnomes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">project_dir</span> <span class="op">&lt;-</span> <span class="st">"/proj/mnhallqlab/projects/bg08test_14feb2026"</span></span>
<span><span class="va">scfg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_project.html">load_project</a></span><span class="op">(</span><span class="va">project_dir</span>, validate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>validate = FALSE</code> is useful when loading from
non-interactive contexts, because validation can otherwise trigger
interactive correction prompts.</p>
</div>
</div>
<div class="section level2">
<h2 id="project-level-triage-with-get_project_status">Project-level triage with <code>get_project_status()</code><a class="anchor" aria-label="anchor" href="#project-level-triage-with-get_project_status"></a>
</h2>
<p>Start with a table of completion flags and times for all
subjects:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">status_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_project_status.html">get_project_status</a></span><span class="op">(</span><span class="va">scfg</span><span class="op">)</span></span>
<span><span class="va">status_df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">status_df</span><span class="op">)</span></span></code></pre></div>
<p>Captured output (16 Feb 2026):</p>
<pre><code>rows: 10 cols: 12

sub_id  bids_conversion_complete  mriqc_complete  fmriprep_complete  aroma_complete  task_complete
540294  TRUE                     TRUE            FALSE              FALSE           FALSE
540295  TRUE                     TRUE            FALSE              FALSE           FALSE
...     ...                      ...             ...                ...             ...
540311  TRUE                     TRUE            FALSE              FALSE           FALSE

Summary:
step                       n_complete
bids_conversion_complete   10
mriqc_complete             10
fmriprep_complete           0
aroma_complete              0
task_complete               0</code></pre>
<p>This gives a quick pass/fail style view. In this run, BIDS conversion
and MRIQC are complete for all subjects, while downstream steps are not
yet complete.</p>
<p>You can also scan log markers for explicit failures:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>  <span class="va">scfg</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">log_directory</span>,</span>
<span>  pattern <span class="op">=</span> <span class="st">"_fail$"</span>,</span>
<span>  recursive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  full.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Captured output:</p>
<pre><code>[1] "sub-540295/.fmriprep_sub-540295_fail"
[2] "sub-540300/.fmriprep_sub-540300_fail"
[3] "sub-540301/.fmriprep_sub-540301_fail"
[4] "sub-540302/.fmriprep_sub-540302_fail"
[5] "sub-540303/.aroma_sub-540303_fail"</code></pre>
</div>
<div class="section level2">
<h2 id="subject-level-check-with-get_subject_status">Subject-level check with <code>get_subject_status()</code><a class="anchor" aria-label="anchor" href="#subject-level-check-with-get_subject_status"></a>
</h2>
<p>To check one subject:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_subject_status.html">get_subject_status</a></span><span class="op">(</span><span class="va">scfg</span>, <span class="st">"540296"</span><span class="op">)</span></span></code></pre></div>
<p>Captured output:</p>
<pre><code>  sub_id ses_id bids_conversion_complete bids_conversion_time mriqc_complete
1 540296   &lt;NA&gt;                     TRUE  2026-02-14 18:27:01           TRUE
           mriqc_time fmriprep_complete fmriprep_time aroma_complete aroma_time
1 2026-02-15 04:00:02             FALSE          &lt;NA&gt;          FALSE       &lt;NA&gt;
  task_complete task_time
1         FALSE      &lt;NA&gt;</code></pre>
<p>This is often the fastest way to answer, “Where is subject X
stuck?”</p>
</div>
<div class="section level2">
<h2 id="interactive-diagnosis-with-diagnose_pipeline">Interactive diagnosis with <code>diagnose_pipeline()</code><a class="anchor" aria-label="anchor" href="#interactive-diagnosis-with-diagnose_pipeline"></a>
</h2>
<p><code><a href="../reference/diagnose_pipeline.html">diagnose_pipeline()</a></code> gives a tree view plus optional
log-tail inspection.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/diagnose_pipeline.html">diagnose_pipeline</a></span><span class="op">(</span><span class="va">scfg</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="sequence-first-walkthrough">Sequence-first walkthrough<a class="anchor" aria-label="anchor" href="#sequence-first-walkthrough"></a>
</h3>
<p>Prompt decisions used:</p>
<pre><code>Enter 1 for subject summary or 2 for sequence ID
&gt; 2

Enter which pipeline run to diagnose. The default is the most recent.
&gt; [Enter]</code></pre>
<p>Captured output excerpt:</p>
<pre><code>The run you selected had 2 top-level jobs:

Subject: sub-540296
  bids_conversion_sub-540296 [COMPLETED]
  mriqc_sub-540296           [COMPLETED]
  fmriprep_sub-540296        [COMPLETED]
  aroma_sub-540296           [STARTED]
  postprocess_task_sub-540296[QUEUED]
  extract_rois_sub-540296    [QUEUED]
...
Would you like to examine any of these jobs more closely?</code></pre>
</div>
<div class="section level3">
<h3 id="drill-down-to-a-specific-job-and-inspect-logs">Drill down to a specific job and inspect logs<a class="anchor" aria-label="anchor" href="#drill-down-to-a-specific-job-and-inspect-logs"></a>
</h3>
<p>Prompt decisions used:</p>
<pre><code>Would you like to examine any of these jobs more closely?
&gt; yes

Enter the job number from the list above
&gt; 17

Further diagnosis...
1. View the output file in console
2. Return output file as character object
3. View the error file in the console
4. Return error file as character object
5. Exit</code></pre>
<p>For this run, job <code>17</code> was
<code>fmriprep_sub-540296</code>.</p>
<p>Captured details:</p>
<pre><code>Job `fmriprep_sub-540296`...
...was submitted at 2026-02-14 17:53:38.310812
...was started at 2026-02-14 18:27:15.174171
...successfully completed at 2026-02-14 23:56:17.037141
...had 1 child job
Child job details:
1 of 1 [STARTED]: aroma_sub-540296</code></pre>
<p>Example error-tail output excerpt:</p>
<pre><code>Warning: The system is configured to read the RTC time in the local time zone...</code></pre>
<p>Example output-tail excerpt:</p>
<pre><code>... nipype.workflow IMPORTANT: fMRIPrep finished successfully!
... Finished fmriprep for subject 540296 (time elapsed: 5h 29m 5s)</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="subject-first-diagnosis-path">Subject-first diagnosis path<a class="anchor" aria-label="anchor" href="#subject-first-diagnosis-path"></a>
</h2>
<p>If you already know the subject you care about, use the
subject-summary branch:</p>
<pre><code>Enter 1 for subject summary or 2 for sequence ID
&gt; 1

Found 10 subject(s) across all runs.
Enter the number corresponding to the subject you want to view
&gt; 3</code></pre>
<p>Captured output excerpt for <code>sub-540296</code>:</p>
<pre><code>Subject Summary: sub-540296
  bids_conversion_sub-540296 [COMPLETED]
  mriqc_sub-540296           [COMPLETED]
  fmriprep_sub-540296        [COMPLETED]
  aroma_sub-540296           [STARTED]
  postprocess_task_sub-540296[QUEUED]
  extract_rois_sub-540296    [QUEUED]</code></pre>
<p>You can then continue into sequence-level and job-level inspection
from there.</p>
</div>
<div class="section level2">
<h2 id="interpreting-success-vs-failure">Interpreting success vs failure<a class="anchor" aria-label="anchor" href="#interpreting-success-vs-failure"></a>
</h2>
<p>In <code><a href="../reference/diagnose_pipeline.html">diagnose_pipeline()</a></code>:</p>
<ul>
<li>
<code>COMPLETED</code> means the tracked job finished.</li>
<li>
<code>STARTED</code> means running (or previously started without
terminal status yet).</li>
<li>
<code>QUEUED</code> means waiting on scheduler
dependencies/resources.</li>
<li>
<code>FAILED</code> or <code>FAILED_BY_EXT</code> indicate hard
failure (direct or upstream-caused).</li>
</ul>
<p>In <code><a href="../reference/get_project_status.html">get_project_status()</a></code> and
<code><a href="../reference/get_subject_status.html">get_subject_status()</a></code>, <code>*_complete</code> flags are
stricter and include checks beyond simple queue status (for example,
completion markers and output state).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
