% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postprocess_functions.R
\name{framewise_displacement}
\alias{framewise_displacement}
\title{Compute framewise displacement from motion parameters}
\usage{
framewise_displacement(
  motion,
  head_radius = 50,
  columns = c("rot_x", "rot_y", "rot_z", "trans_x", "trans_y", "trans_z"),
  rot_units = c("rad", "deg"),
  drop_volumes = 0L,
  last_volume = NULL,
  na_action = 0
)
}
\arguments{
\item{motion}{Numeric matrix or data frame with columns for
\code{rot_x}, \code{rot_y}, \code{rot_z}, \code{trans_x}, \code{trans_y}, and \code{trans_z}.}

\item{head_radius}{Radius of the head (in millimetres) used to convert
rotational parameters to linear displacements. Defaults to 50 mm.}

\item{columns}{Character vector giving the column order expected in
\code{motion}. Defaults to the six canonical fMRIPrep motion columns.}

\item{rot_units}{Unit of the rotation parameters (\code{"rad"} or
\code{"deg"}). Values in degrees are internally converted to radians
prior to differencing.}

\item{drop_volumes}{Number of leading timepoints to discard (e.g., if
dummy scans were dropped from the fMRI data). Defaults to 0.}

\item{last_volume}{Optional index of the final volume to retain. If
supplied, frames beyond \code{last_volume} are excluded before FD is
computed.}

\item{na_action}{Replacement applied to any remaining \code{NA} values
after subsetting. Defaults to \code{0}, matching the behavior used in
\code{notch_filter()}.}
}
\value{
Numeric vector of framewise displacement values (same length
as the number of rows in \code{motion}). The first entry is zero by
definition.
}
\description{
Calculates Power-style framewise displacement (FD) from a matrix or
data frame containing the six rigid-body motion parameters. Rotations
are converted to displacements on the surface of a sphere with radius
\code{head_radius} (in millimetres) before summation. Optional arguments
mirror typical preprocessing steps (dropping initial dummy scans,
truncating to a final volume, or handling rotations recorded in
degrees).
}
\keyword{internal}
