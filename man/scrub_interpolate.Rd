% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postprocess_functions.R
\name{scrub_interpolate}
\alias{scrub_interpolate}
\title{Interpolate Over Censored Timepoints in a 4D NIfTI Image}
\usage{
scrub_interpolate(
  in_file,
  censor_file,
  out_file,
  confound_files = NULL,
  overwrite = FALSE,
  lg = NULL
)
}
\arguments{
\item{in_file}{Path to the input 4D NIfTI image file.}

\item{censor_file}{Path to a 1D censor file (e.g., from fMRI preprocessing)
containing a binary vector of \code{1}s (keep) and \code{0}s (scrub) for each timepoint.}

\item{out_file}{The full path for the file output by this step}

\item{confound_files}{Optional character vector of confound or regressor
files to update alongside the fMRI data. Rows corresponding to interpolated
volumes are filled in using natural splines with nearest-neighbor
extrapolation.}

\item{overwrite}{Logical indicating whether to overwrite an existing interpolated
file (default is \code{FALSE}).}

\item{lg}{Optional \code{Logger} object (from the \code{lgr} package) for logging output.
If not provided, the root logger is used.}
}
\value{
A character string giving the path to the interpolated output NIfTI file.
If the file already exists and \code{overwrite = FALSE}, the existing file path is returned.
}
\description{
Applies cubic spline interpolation to a 4D fMRI image to replace censored
(scrubbed) timepoints, as defined in a censor file. Timepoints with a value
of \code{0} in the censor file are interpolated across using voxelwise natural
splines, with nearest-neighbor extrapolation at the edges.
}
\details{
Timepoints to interpolate are identified as those with a \code{0} in the \code{censor_file}.
These are replaced using voxelwise cubic spline interpolation across the remaining
timepoints. Extrapolation at the beginning or end of the series uses the nearest
valid value (i.e., \code{edge_nn = TRUE}).

This function relies on a lower-level Rcpp function \code{natural_spline_4d()}
that performs the actual interpolation.
}
\keyword{internal}
