% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/postprocess_functions.R
\name{notch_filter}
\alias{notch_filter}
\title{Notch filter regressors (esp. motion parameters) from the confounds file}
\usage{
notch_filter(
  confounds_df = NULL,
  tr = NULL,
  bandstop_min_bpm = NULL,
  bandstop_max_bpm = NULL,
  columns = c("rot_x", "rot_y", "rot_z", "trans_x", "trans_y", "trans_z"),
  add_poly = TRUE,
  out_file = NULL,
  padtype = "constant",
  padlen = NULL,
  use_zi = TRUE,
  lg = NULL
)
}
\arguments{
\item{confounds_df}{A data frame containing confound regressors to filter.}

\item{tr}{The repetition time of the scan sequence in seconds. Used
to check that the stop band falls within the}

\item{bandstop_min_bpm}{Lower bound of the notch stop-band, in breaths
per minute. This will be converted to Hz internally.}

\item{bandstop_max_bpm}{Upper bound of the notch stop-band, in breaths
per minute. This will be converted to Hz internally.}

\item{columns}{Columns in \code{confounds_df} to filter. Defaults to the standard six
rigid-body parameters: \code{rot_x}, \code{rot_y}, \code{rot_z}, \code{trans_x},
\code{trans_y}, \code{trans_z}.}

\item{out_file}{Optional output path. When provided, the filtered
confounds table is written here (tab-delimited). If \code{NULL}, the
modified table is returned invisibly.}

\item{padtype}{Passed to \code{\link[=filtfilt_cpp]{filtfilt_cpp()}}; governs how the edges are
padded before filtering. One of \code{"constant"}, \code{"odd"}, \code{"even"}, or
\code{"zero"}. Defaults to \code{"constant"} to match SciPy.}

\item{padlen}{Optional integer pad length forwarded to
\code{\link[=filtfilt_cpp]{filtfilt_cpp()}}. If \code{NULL}, the default inside \code{filtfilt_cpp()}
(\code{-1L}) is used.}

\item{use_zi}{Logical; whether to initialise the filter state using
steady-state conditions (the default in \code{filtfilt_cpp()}).}

\item{lg}{Optional \code{Logger} (from \code{lgr}) used for status messages.}
}
\value{
If \code{out_file} is \code{NULL}, the filtered confounds are returned
as a data frame. Otherwise the path to \code{out_file} is returned
invisibly.
}
\description{
Uses \code{iirnotch_r()} to design a single-frequency notch filter that
suppresses respiratory-related oscillations in the six rigid-body
motion parameters. The function filters the requested columns with
\code{\link[=filtfilt_cpp]{filtfilt_cpp()}} (zero-phase), and optionally writes the updated
confounds table to disk.
}
\keyword{internal}
