<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply SUSAN-based spatial smoothing to a 4D fMRI image — spatial_smooth • BrainGnomes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply SUSAN-based spatial smoothing to a 4D fMRI image — spatial_smooth"><meta name="description" content="Performs spatial smoothing using FSL's susan algorithm, which adapts smoothing based
on local image intensity structure. A smoothing kernel defined by fwhm_mm is applied
and the extents mask is re-applied post-smoothing to constrain the result to original data extents."><meta property="og:description" content="Performs spatial smoothing using FSL's susan algorithm, which adapts smoothing based
on local image intensity structure. A smoothing kernel defined by fwhm_mm is applied
and the extents mask is re-applied post-smoothing to constrain the result to original data extents."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainGnomes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/braingnomes_quickstart.html">BrainGnomes Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/building_containers.html">Building Singularity containers for BrainGnomes</a></li>
    <li><a class="dropdown-item" href="../articles/extract_rois.html">Extracting ROI Timeseries and Connectivity</a></li>
    <li><a class="dropdown-item" href="../articles/postprocessing.html">BrainGnomes Postprocessing Walkthrough</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UNCDEPENdLab/BrainGnomes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply SUSAN-based spatial smoothing to a 4D fMRI image</h1>
      <small class="dont-index">Source: <a href="https://github.com/UNCDEPENdLab/BrainGnomes/blob/0.7-2/R/postprocess_functions.R" class="external-link"><code>R/postprocess_functions.R</code></a></small>
      <div class="d-none name"><code>spatial_smooth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs spatial smoothing using FSL's <code>susan</code> algorithm, which adapts smoothing based
on local image intensity structure. A smoothing kernel defined by <code>fwhm_mm</code> is applied
and the extents mask is re-applied post-smoothing to constrain the result to original data extents.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatial_smooth</span><span class="op">(</span></span>
<span>  <span class="va">in_file</span>,</span>
<span>  <span class="va">out_file</span>,</span>
<span>  fwhm_mm <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  brain_mask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fsl_img <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-in-file">in_file<a class="anchor" aria-label="anchor" href="#arg-in-file"></a></dt>
<dd><p>Path to the input 4D NIfTI file.</p></dd>


<dt id="arg-out-file">out_file<a class="anchor" aria-label="anchor" href="#arg-out-file"></a></dt>
<dd><p>The full path for the file output by this step</p></dd>


<dt id="arg-fwhm-mm">fwhm_mm<a class="anchor" aria-label="anchor" href="#arg-fwhm-mm"></a></dt>
<dd><p>Full-width at half-maximum (FWHM) of the Gaussian kernel in millimeters.</p></dd>


<dt id="arg-brain-mask">brain_mask<a class="anchor" aria-label="anchor" href="#arg-brain-mask"></a></dt>
<dd><p>Optional brain mask to guide intensity thresholding. If <code>NULL</code>, the whole image is used.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical; whether to overwrite the output file if it already exists.</p></dd>


<dt id="arg-lg">lg<a class="anchor" aria-label="anchor" href="#arg-lg"></a></dt>
<dd><p>Optional lgr object used for logging messages</p></dd>


<dt id="arg-fsl-img">fsl_img<a class="anchor" aria-label="anchor" href="#arg-fsl-img"></a></dt>
<dd><p>Optional Singularity image to execute FSL commands in a containerized environment.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Path to the spatially smoothed output NIfTI file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The SUSAN threshold is computed based on the 2nd and 50th percentiles of intensity values.
An extents mask is created prior to smoothing to ensure no new voxels are introduced in the output.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

