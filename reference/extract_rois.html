<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract ROI timeseries and connectivity matrices — extract_rois • BrainGnomes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract ROI timeseries and connectivity matrices — extract_rois"><meta name="description" content="Given a postprocessed BOLD NIfTI file and one or more atlas images,
this function computes the mean timeseries within each ROI and
optionally computes ROI-to-ROI correlation matrices."><meta property="og:description" content="Given a postprocessed BOLD NIfTI file and one or more atlas images,
this function computes the mean timeseries within each ROI and
optionally computes ROI-to-ROI correlation matrices."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainGnomes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/braingnomes_quickstart.html">BrainGnomes Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/building_containers.html">Building Singularity containers for BrainGnomes</a></li>
    <li><a class="dropdown-item" href="../articles/postprocessing.html">BrainGnomes Postprocessing Walkthrough</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UNCDEPENdLab/BrainGnomes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extract ROI timeseries and connectivity matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/UNCDEPENdLab/BrainGnomes/blob/main/R/extract_rois.R" class="external-link"><code>R/extract_rois.R</code></a></small>
      <div class="d-none name"><code>extract_rois.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a postprocessed BOLD NIfTI file and one or more atlas images,
this function computes the mean timeseries within each ROI and
optionally computes ROI-to-ROI correlation matrices.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_rois</span><span class="op">(</span></span>
<span>  <span class="va">bold_file</span>,</span>
<span>  <span class="va">atlas_files</span>,</span>
<span>  <span class="va">out_dir</span>,</span>
<span>  log_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"kendall"</span>, <span class="st">"cor.shrink"</span><span class="op">)</span>,</span>
<span>  roi_reduce <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"pca"</span>, <span class="st">"huber"</span><span class="op">)</span>,</span>
<span>  brain_mask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_vox_per_roi <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  save_ts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rtoz <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bold-file">bold_file<a class="anchor" aria-label="anchor" href="#arg-bold-file"></a></dt>
<dd><p>Path to a 4D NIfTI file containing postprocessed BOLD data.</p></dd>


<dt id="arg-atlas-files">atlas_files<a class="anchor" aria-label="anchor" href="#arg-atlas-files"></a></dt>
<dd><p>Character vector of atlas NIfTI files with integer
ROI labels.</p></dd>


<dt id="arg-out-dir">out_dir<a class="anchor" aria-label="anchor" href="#arg-out-dir"></a></dt>
<dd><p>Directory where output files should be written.</p></dd>


<dt id="arg-log-file">log_file<a class="anchor" aria-label="anchor" href="#arg-log-file"></a></dt>
<dd><p>If not <code>NULL</code>, the log file to which details should be written.</p></dd>


<dt id="arg-cor-method">cor_method<a class="anchor" aria-label="anchor" href="#arg-cor-method"></a></dt>
<dd><p>Correlation method(s) to use when computing functional
connectivity. Supported options include "pearson", "spearman",
"kendall", and "cor.shrink". Use "none" to skip correlation
computation. Multiple methods may be supplied.</p></dd>


<dt id="arg-roi-reduce">roi_reduce<a class="anchor" aria-label="anchor" href="#arg-roi-reduce"></a></dt>
<dd><p>Method used to summarize voxel time series within each
ROI. Options are "mean" (default), "median", "pca", or "huber".</p></dd>


<dt id="arg-brain-mask">brain_mask<a class="anchor" aria-label="anchor" href="#arg-brain-mask"></a></dt>
<dd><p>Optional brain mask NIfTI file. If <code>NULL</code>, a mask
is generated by excluding voxels with zero variance across time.</p></dd>


<dt id="arg-min-vox-per-roi">min_vox_per_roi<a class="anchor" aria-label="anchor" href="#arg-min-vox-per-roi"></a></dt>
<dd><p>The minimum number of voxels required for an ROI to
be extracted and entered into correlations. If the ROI is smaller than this,
it show up as NA in the outputs, keeping the dimensionality of the connectivity
matrix consistent across inputs. Default: <code>5</code></p></dd>


<dt id="arg-save-ts">save_ts<a class="anchor" aria-label="anchor" href="#arg-save-ts"></a></dt>
<dd><p>If <code>TRUE</code>, save the ROI time series (aggregated using <code>roi_reduce</code> method)
to <code>_timeseries.tsv</code>. files. Useful for running external analyses on the ROIs. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-rtoz">rtoz<a class="anchor" aria-label="anchor" href="#arg-rtoz"></a></dt>
<dd><p>If <code>TRUE</code>, using Fisher's z (aka atanh) transformation on correlations to make them
continuous and unbounded, rather than <code>[0,1]</code>. The diagonal of the correlation matrices beccomes
15 to approximate the 1.0 correlation, rather than making it <code>Inf</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>If <code>TRUE</code>, overwrite existing timeseries.tsv or connectivity.tsv files.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list. Each element corresponds to an atlas and contains
paths to the written timeseries (<code>timeseries</code>) and correlation
matrix (<code>correlation</code>, or <code>NULL</code> if not computed).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Voxels labelled in the atlas but lying outside the brain are
automatically excluded by intersecting with a brain mask derived from
the input timeseries.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

