<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interpolate fMRI Time Series with Cubic Splines in a NIfTI File — natural_spline_4d • BrainGnomes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpolate fMRI Time Series with Cubic Splines in a NIfTI File — natural_spline_4d"><meta name="description" content="This function performs voxelwise natural cubic spline interpolation over the time
dimension of a 4D NIfTI image. Timepoints to interpolate are specified, and interpolation
is applied independently to each voxel's time series."><meta property="og:description" content="This function performs voxelwise natural cubic spline interpolation over the time
dimension of a 4D NIfTI image. Timepoints to interpolate are specified, and interpolation
is applied independently to each voxel's time series."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BrainGnomes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/braingnomes_quickstart.html">BrainGnomes Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/building_containers.html">Building Singularity containers for BrainGnomes</a></li>
    <li><a class="dropdown-item" href="../articles/postprocessing.html">BrainGnomes Postprocessing Walkthrough</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UNCDEPENdLab/BrainGnomes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Interpolate fMRI Time Series with Cubic Splines in a NIfTI File</h1>
      <small class="dont-index">Source: <a href="https://github.com/UNCDEPENdLab/BrainGnomes/blob/main/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>natural_spline_4d.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs voxelwise natural cubic spline interpolation over the time
dimension of a 4D NIfTI image. Timepoints to interpolate are specified, and interpolation
is applied independently to each voxel's time series.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-infile">infile<a class="anchor" aria-label="anchor" href="#arg-infile"></a></dt>
<dd><p>Character string. Path to the input 4D NIfTI file (e.g., BOLD fMRI data).</p></dd>


<dt id="arg-t-interpolate">t_interpolate<a class="anchor" aria-label="anchor" href="#arg-t-interpolate"></a></dt>
<dd><p>Integer vector (1-based). Specifies the timepoints (TRs) to interpolate.
Timepoints outside the valid range <code>[1, T]</code> are ignored with a warning.</p></dd>


<dt id="arg-edge-nn">edge_nn<a class="anchor" aria-label="anchor" href="#arg-edge-nn"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, extrapolated values at the edges of the time series
are filled in using nearest-neighbor extrapolation instead of cubic splines.</p></dd>


<dt id="arg-outfile">outfile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>Character string (optional). If provided, the interpolated image will
be written to this path. If omitted, the result is returned but not saved.</p></dd>


<dt id="arg-internal">internal<a class="anchor" aria-label="anchor" href="#arg-internal"></a></dt>
<dd><p>Logical. If FALSE (the default), an array of class "niftiImage", containing
the image pixel or voxel values, will be returned. If TRUE, the return value will be
an object of class "internalImage", which contains only minimal metadata about the image.
Either way, the return value has an attribute which points to a C data structure
containing the full image. Cf. <code><a href="https://rdrr.io/pkg/RNifti/man/readNifti.html" class="external-link">RNifti::readNifti</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>niftiImage</code> object with the same dimensions and metadata as the input,
with interpolated values inserted at the specified timepoints.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function reads the NIfTI image from disk, performs interpolation in memory,
and optionally writes the result back to a new NIfTI file.</p>
<p>The interpolation is voxelwise and assumes column-major order. If a voxel time series
has fewer than three valid (non-interpolated) timepoints, or is constant across time, it is skipped.
Linear extrapolation is used for timepoints outside the valid range if <code>edge_nn = FALSE</code>, matching
R's <code>splinefun</code> approach with natural splines. If <code>edge_nn = TRUE</code>, nearest-neighbor extrapolation
is used for interpolation timepoints at the beginning or end of the timeseries, potentially reducing
extreme values in extrapolation.</p>
<p>This implementation uses RNifti's C++ API (<code>NiftiImage</code>, <code>NiftiImageData</code>) for efficient
memory access and file handling, allowing the function to operate directly on NIfTI files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">out_img</span> <span class="op">&lt;-</span> <span class="fu">natural_spline_4d</span><span class="op">(</span></span></span>
<span class="r-in"><span>  infile <span class="op">=</span> <span class="st">"bold.nii.gz"</span>,</span></span>
<span class="r-in"><span>  t_interpolate <span class="op">=</span> <span class="fl">91</span><span class="op">:</span><span class="fl">95</span>,</span></span>
<span class="r-in"><span>  outfile <span class="op">=</span> <span class="st">"bold_interpolated.nii.gz"</span>,</span></span>
<span class="r-in"><span>  edge_nn <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

